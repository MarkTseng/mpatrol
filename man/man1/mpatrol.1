.\" mpatrol
.\" A library for controlling and tracing dynamic memory allocations.
.\" Copyright (C) 1997-2000 Graeme S. Roy <graeme@epc.co.uk>
.\"
.\" This library is free software; you can redistribute it and/or
.\" modify it under the terms of the GNU Library General Public
.\" License as published by the Free Software Foundation; either
.\" version 2 of the License, or (at your option) any later version.
.\"
.\" This library is distributed in the hope that it will be useful,
.\" but WITHOUT ANY WARRANTY; without even the implied warranty of
.\" MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
.\" Library General Public License for more details.
.\"
.\" You should have received a copy of the GNU Library General Public
.\" License along with this library; if not, write to the Free
.\" Software Foundation, Inc., 59 Temple Place, Suite 330, Boston,
.\" MA 02111-1307, USA.
.\"
.\" UNIX Manual Page
.\"
.\" $Id: mpatrol.1,v 1.5 2000-01-09 20:56:39 graeme Exp $
.\"
.TH MPATROL 1 "9 January 2000" "Release 1.1" "mpatrol library"
.SH NAME
mpatrol \- runs programs using the mpatrol library
.SH SYNOPSIS
\fBmpatrol\fP [\fIoptions\fP] <\fIcommand\fP> [\fIarguments\fP]
.SH DESCRIPTION
The \fBmpatrol\fP command is used to set various mpatrol library \fIoptions\fP
when running \fIcommand\fP with its \fIarguments\fP.  In most cases,
\fIcommand\fP must have been linked with the mpatrol library, unless the
\fI\-d\fP option is used in which case \fIcommand\fP need only have been
dynamically linked.
.PP
All mpatrol library diagnostics are sent to the file \fImpatrol.%n.log\fP in the
current directory by default (where \fI%n\fP is the current process id) but this
can be changed using the \fB\-l\fP option.  Any existing \fBMPATROL_OPTIONS\fP
environment variable settings which are not overridden by \fIoptions\fP will be
passed through unchanged to the mpatrol library.
.SH OPTIONS
All of the following options (except \fB\-d\fP) correspond to their listed
mpatrol library option.  See \fBmpatrol\fP(3) for more details on these options.
.TP
\fB\-A\fP <\fIunsigned integer\fP>
[\fBALLOCSTOP\fP]  Specifies an allocation index at which to stop the program
when it is being allocated.
.TP
\fB\-a\fP <\fIunsigned integer\fP>
[\fBALLOCBYTE\fP]  Specifies an 8-bit byte pattern with which to prefill
newly-allocated memory.
.TP
\fB\-C\fP <\fIunsigned range\fP>
[\fBCHECK\fP]  Specifies a range of allocation indices at which to check the
integrity of free memory and overflow buffers.
.TP
\fB\-c\fP
[\fBCHECKALL\fP]  Specifies that all arguments to functions which allocate,
reallocate and deallocate memory have rigorous checks performed on them.
.TP
\fB\-D\fP <\fIunsigned integer\fP>
[\fBDEFALIGN\fP]  Specifies the default alignment for general-purpose memory
allocations, which must be a power of two.
.TP
\fB\-d\fP
Specifies that the \fBLD_PRELOAD\fP environment variable should be set so that
even programs that were not compiled with the mpatrol library can be traced, but
only if they were dynamically linked.  This option will only work if the dynamic
linker recognises the \fBLD_PRELOAD\fP environment variable.
.TP
\fB\-e\fP <\fIstring\fP>
[\fBPROGFILE\fP]  Specifies an alternative filename with which to locate the
executable file containing the program's symbols.
.TP
\fB\-F\fP <\fIunsigned integer\fP>
[\fBFREESTOP\fP]  Specifies an allocation index at which to stop the program
when it is being freed.
.TP
\fB\-f\fP <\fIunsigned integer\fP>
[\fBFREEBYTE\fP]  Specifies an 8-bit byte pattern with which to prefill
newly-freed memory.
.TP
\fB\-g\fP
[\fBSAFESIGNALS\fP]  Instructs the library to save and replace certain signal
handlers during the execution of library code and to restore them afterwards.
.TP
\fB\-L\fP <\fIunsigned integer\fP>
[\fBLIMIT\fP]  Specifies the limit in bytes at which all memory allocations
should fail if the total allocated memory should increase beyond this.
.TP
\fB\-l\fP <\fIstring\fP>
[\fBLOGFILE\fP]  Specifies an alternative file in which to place all diagnostics
from the mpatrol library.
.TP
\fB\-m\fP
[\fBUSEMMAP\fP]  Specifies that the library should use \fBmmap()\fP instead of
\fBsbrk()\fP to allocate system memory.
.TP
\fB\-N\fP
[\fBNOPROTECT\fP]  Specifies that the mpatrol library's internal data structures
should not be made read-only after every memory allocation, reallocation or
deallocation.
.TP
\fB\-n\fP
[\fBNOFREE\fP]  Specifies that the mpatrol library should keep all reallocated
and freed memory allocations.
.TP
\fB\-O\fP <\fIunsigned integer\fP>
[\fBOFLOWSIZE\fP]  Specifies the size in bytes to use for all overflow buffers,
which must be a power of two.
.TP
\fB\-o\fP <\fIunsigned integer\fP>
[\fBOFLOWBYTE\fP]  Specifies an 8-bit byte pattern with which to fill the
overflow buffers of all memory allocations.
.TP
\fB\-P\fP
[\fBPAGEALLOC\fP=\fIUPPER\fP]  Specifies that each individual memory allocation
should occupy at least one page of virtual memory and should be placed at the
highest point within these pages.
.TP
\fB\-p\fP
[\fBPAGEALLOC\fP=\fILOWER\fP]  Specifies that each individual memory allocation
should occupy at least one page of virtual memory and should be placed at the
lowest point within these pages.
.TP
\fB\-R\fP <\fIunsigned integer\fP>
[\fBREALLOCSTOP\fP]  Specifies an allocation index at which to stop the program
when a memory allocation is being reallocated.
.TP
\fB\-S\fP
[\fBSHOWMAP\fP & \fBSHOWSYMBOLS\fP]  Specifies that a memory map of the entire
heap and a summary of all of the function symbols read from the program's
executable file should be displayed at the end of program execution.
.TP
\fB\-s\fP
[\fBSHOWFREED\fP & \fBSHOWUNFREED\fP]  Specifies that a summary of all of the
freed and unfreed memory allocations should be displayed at the end of program
execution.
.TP
\fB\-U\fP <\fIunsigned integer\fP>
[\fBUNFREEDABORT\fP]  Specifies the minimum number of unfreed allocations at
which to abort the program just before program termination.
.TP
\fB\-v\fP
[\fBPRESERVE\fP]  Specifies that any reallocated or freed memory allocations
should preserve their original contents.
.TP
\fB\-w\fP
[\fBOFLOWWATCH\fP]  Specifies that watch point areas should be used for overflow
buffers rather than filling with the overflow byte.
.TP
\fB\-Z\fP <\fIunsigned integer\fP>
[\fBFAILSEED\fP]  Specifies the random number seed which will be used when
determining which memory allocations will randomly fail.
.TP
\fB\-z\fP <\fIunsigned integer\fP>
[\fBFAILFREQ\fP]  Specifies the frequency at which all memory allocations will
randomly fail.
.SH SEE ALSO
\fBmpatrol\fP(3).
.PP
The mpatrol manual.
.SH AUTHOR
Graeme S. Roy <graeme@epc.co.uk>
.SH COPYRIGHT
Copyright (C) 1997-2000 Graeme S. Roy <graeme@epc.co.uk>
.PP
This library is free software; you can redistribute it and/or modify it under
the terms of the GNU Library General Public License as published by the Free
Software Foundation; either version 2 of the License, or (at your option) any
later version.
.PP
This library is distributed in the hope that it will be useful, but WITHOUT
ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU Library General Public License for more
details.
.PP
You should have received a copy of the GNU Library General Public License
along with this library; if not, write to the Free Software Foundation, Inc.,
59 Temple Place, Suite 330, Boston, MA 02111-1307, USA.
